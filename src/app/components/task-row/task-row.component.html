<div class="task-row" [class.dense]="dense" [class.done]="task.status === 'done'">
  <!-- 左のステータス丸 -->
  <div class="status-dot" [style.background]="statusColor(task.status)"></div>

  <!-- 中央コンテンツ -->
  <div class="task-content">
    <!-- タイトル行 -->
    <div class="task-title">
      <span class="title-text">{{ task.title }}</span>
      <span *ngIf="task.priority" class="priority">[{{ task.priority }}]</span>
    </div>

    <!-- メタ情報行 -->
    <div class="task-meta">
      <!-- 期日バッジ -->
      <span class="due" [ngClass]="['badge', dueBadge(task)]">
        {{ dueLabel(task) }}
      </span>

      <!-- 担当者 -->
      <span class="assignees" matTooltip="{{ assignees(task) }}">
        <mat-icon>group</mat-icon>
        <span>{{ assignees(task) }}</span>
      </span>

      <!-- タグ数（0のときは非表示） -->
      <span class="metric" *ngIf="tagsCount(task) > 0">
        <mat-icon>sell</mat-icon>
        <span>{{ tagsCount(task) }}</span>
      </span>

      <!-- コメント数 -->
      <span class="metric">
        <mat-icon>forum</mat-icon>
        <span>{{ commentCount(task) }}</span>
      </span>

      <!-- 添付ファイル数 -->
      <span class="metric">
        <mat-icon>attach_file</mat-icon>
        <span>{{ attachmentCount(task) }}</span>
      </span>
    </div>
  </div>

  <div class="actions" *ngIf="actionConfig">
    <!-- 完了ボタン（残す場合） -->
    <button
      class="action-complete"
      *ngIf="actions.complete !== false"
      mat-icon-button
      matTooltip="完了にする"
      (click)="complete.emit(task)">
      <mat-icon>check_circle</mat-icon>
    </button>
  
    <!-- −1日 -->
    <button
      *ngIf="actions.shift !== false"
      mat-icon-button
      matTooltip="-1日"
      [disabled]="busy || !task.dueDate"
      (click)="shiftDays.emit({ task, days: -1 })">
      <mat-icon>arrow_back</mat-icon>
    </button>
  
    <!-- ＋1日 -->
    <button
      *ngIf="actions.shift !== false"
      mat-icon-button
      matTooltip="+1日"
      [disabled]="busy || !task.dueDate"
      (click)="shiftDays.emit({ task, days: 1 })">
      <mat-icon>arrow_forward</mat-icon>
    </button>
  
    <!-- 今日にする -->
    <button
      *ngIf="actions.setToday !== false"
      mat-icon-button
      matTooltip="今日にする"
      [disabled]="busy"
      (click)="setToday.emit(task)">
      <mat-icon>today</mat-icon>
    </button>
  
    <!-- ボードを開く -->
    <a
      *ngIf="task.problemId && task.issueId"
      mat-icon-button
      [routerLink]="['/board']"
      [queryParams]="{ pid: task.problemId }"
      matTooltip="{{ 'schedule.openInBoard' | translate }}">
      <mat-icon>open_in_new</mat-icon>
    </a>
  </div>
  
</div>




