.schedule-page{
  display:flex; flex-direction:column;
  gap:calc(var(--gap-4) + 12px * var(--m));
  padding:var(--pad-2);
  font-size:var(--fs-b); line-height:1.5; min-width:0;
}

/* ── ヘッダー共通 ─────────────────────────── */
.page-header{ display:flex; flex-direction:column; gap:var(--gap-3); }
.headline{ display:flex; justify-content:space-between; align-items:center; gap:var(--gap-3); flex-wrap:wrap; }
.headline > *{ min-width:0; }
.headline h1{ margin:0; font-size:var(--fs-t); line-height:1.3; }
.headline .muted{ margin-top:calc(4px * var(--m)); }
.view-toggle{ display:inline-flex; align-items:center; border-radius:999px; min-width:0; }

/* ── ヘッダー上段レイアウト ─────────────────── */
/* デフォルト：広い画面は4カラム */
.header-grid{
  --header-mid-gap: clamp(36px, 8vw, 120px);    /* Export と 表示のあいだの“専用”余白 */
  display:grid;
  grid-template-columns: max-content var(--header-mid-gap) auto 1fr; /* 1:Export 2:Spacer 3:表示 4:右フィルタ */
  column-gap: var(--gap-3);
  align-items:end;
  min-width:0;
}
.export-card{ grid-column:1; }
.center-controls{ grid-column:3; justify-self:start; min-width:0; }
.right-filters{ grid-column:4; }

/* Export ボックス（横伸びしない） */
.export-card{
  display:inline-flex; align-items:center; gap:var(--gap-2);
  padding:var(--pad-2);
  border:1px solid var(--divider); border-radius:var(--radius);
  background:var(--surface); box-shadow:var(--shadow, 0 2px 8px rgba(0,0,0,0.03));
  width:max-content;
}
.export-card .group-title{ display:inline-flex; align-items:center; gap:var(--gap-1); font-weight:600; color:var(--muted); white-space:nowrap; }
.export-card .group-actions{ display:inline-flex; gap:var(--gap-2); }

/* 表示（中央） */
.center-controls{
  display:flex; flex-direction:column; gap:var(--gap-1);
  text-align:left; overflow:hidden;           /* はみ出し防止 */
}
.center-controls .control-label{ font-weight:600; font-size:var(--fs-b); color:var(--muted); }
.center-controls .mat-button-toggle-group,
.center-controls mat-button-toggle-group{ max-width:100%; display:inline-flex; flex-wrap:wrap; } /* 必要なら折返し */

/* 右：タグ（左）＋担当者（右） */
.right-filters{
  display:flex; align-items:end; justify-content:flex-end;
  gap: clamp(16px, 2.5vw, 40px);
  flex-wrap:nowrap; min-width:0;
}
.filter-group{ display:flex; flex-direction:column; gap:var(--gap-1); min-width:0; }
.filter-group label{ font-weight:600; font-size:var(--fs-b); }
.filter-group input{
  padding:calc(10px * var(--m)) calc(12px * var(--m));
  border-radius:var(--radius); border:1px solid var(--border);
  background:var(--surface); color:inherit; min-width:0; font-size:var(--fs-b); line-height:1.4;
}
.filter-group mat-select{ min-width:calc(220px * var(--m)); }

/* タグ：幅を抑えると左端が右へ寄る（右端の位置感は保ちやすい） */
.right-filters .filter-group:first-child{
  flex:0 0 clamp(220px, 22vw, 340px);
}
.right-filters .filter-group:first-child input,
.right-filters .filter-group:first-child mat-form-field{ width:100%; }

/* 担当者：最右固定 */
.right-filters .assignees{ flex:0 0 clamp(220px, 18vw, 320px); }
.right-filters .assignees mat-select{ min-width:calc(220px * var(--m)); }

/* ── ラップトップ幅：2段に分けて重なり回避 ───────── */
@media (max-width: 1400px){
  .header-grid{
    grid-template-columns: 1fr 1fr;          /* 2カラム×複数行 */
    grid-auto-rows: minmax(0, auto);
    column-gap: var(--gap-3);
    row-gap: var(--gap-2);
    --header-mid-gap: 24px;                  /* 中央の専用余白は小さめに */
  }
  .export-card{ grid-column:1; grid-row:1; justify-self:start; }
  .center-controls{ grid-column:2; grid-row:1; justify-self:end; max-width:100%; }
  .right-filters{
    grid-column:1 / -1; grid-row:2;          /* 2行目ぜんぶを使う */
    justify-content:flex-end; flex-wrap:nowrap; gap:clamp(12px, 2vw, 28px);
  }
  /* タグ・担当者の幅も少しだけ絞る */
  .right-filters .filter-group:first-child{ flex:0 1 clamp(200px, 30vw, 320px); }
  .right-filters .assignees{ flex:0 0 clamp(200px, 24vw, 300px); }
}

/* ── タブレット以下：縦積み ─────────────────── */
@media (max-width: 960px){
  .header-grid{ grid-template-columns:1fr; }
  .export-card, .center-controls, .right-filters{ grid-column:auto; grid-row:auto; justify-self:start; }
  .right-filters{ justify-content:flex-start; flex-wrap:wrap; gap:var(--gap-2); }
  .right-filters .filter-group:first-child,
  .right-filters .assignees{ flex:1 1 100%; }
}

/* ── リスト側（既存） ─────────────────────── */
.view-container{ display:block; min-width:0; }
.list-grid{ display:grid; gap:var(--gap-4); grid-template-columns:repeat(auto-fit, minmax(calc(320px * var(--m)), 1fr)); min-width:0; }
mat-card{ display:flex; flex-direction:column; gap:var(--gap-2); padding:var(--pad-2); border-radius:var(--radius); background:var(--surface); box-shadow:var(--shadow, 0 2px 8px rgba(0,0,0,0.03)); }
mat-card.empty{ opacity:.65; }
mat-card header{ display:flex; align-items:flex-start; gap:var(--gap-2); }
mat-card header > *{ min-width:0; }
mat-card header h2{ margin:0; font-size:var(--fs-t); line-height:1.3; font-weight:600; }
.icon{ width:calc(40px * var(--m)); height:calc(40px * var(--m)); border-radius:var(--radius); display:flex; align-items:center; justify-content:center; background:color-mix(in srgb, var(--accent-blue) 10%, transparent); flex-shrink:0; font-size:var(--fs-t); line-height:1; color:var(--accent-blue); }
.icon.danger{ background:color-mix(in srgb, var(--accent-red) 18%, transparent); color:var(--accent-red); }
.icon.info{ background:color-mix(in srgb, var(--accent-blue) 18%, transparent); color:var(--accent-blue); }
.count-badge{ margin-top:var(--gap-1); font-size:var(--fs-b); font-weight:600; color:var(--muted); }
.section-body{ display:flex; flex-direction:column; gap:var(--gap-2); min-width:0; }
.empty{ padding:var(--pad-1); border-radius:var(--radius); border:1px dashed var(--divider); color:var(--muted); text-align:center; font-size:var(--fs-b); line-height:1.4; }

/* ヘッダーとリスト間の余白＆スクロール抑止 */
.schedule-page > .page-header{ margin-bottom:clamp(24px, 3.5vh, 56px); }
.page-header.card{ overflow:visible; max-height:none; -ms-overflow-style:none; scrollbar-width:none; }
.page-header.card::-webkit-scrollbar{ display:none; }
